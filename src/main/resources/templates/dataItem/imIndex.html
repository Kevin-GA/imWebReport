<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common2000::commonHeader('im首页')"></head>
<!--<script type="text/javascript" th:src="@{/js/jquery-1.7.2.min.js}"></script>-->
<BODY class=technology-integr style="width: 1000px"><!-- 头部 S -->
<SCRIPT>var _speedMark = Date.now()</SCRIPT>
<SCRIPT>
    $(function () {
        $(".showPopUpJS").mouseover(function () {
            $(this).addClass("show-dropdown-body");
        });
        $(".showPopUpJS").mouseout(function () {
            $(this).removeClass("show-dropdown-body");
        });
        add_newhouse_box();
        add_esf_box();
        add_jj_box();
        addPageUvCount();
        showCharts1();
        showCharts2();
        showCharts3();
        showCharts4();
        addTable1();
        addTable2();
        addTable3();
        addTable4();


        $("#to-im-list").click(function(){
            window.open("../dataItem/im-list");
        })
        $('.wenhao').hover(function(){
            $(this).find('.wenhao-alert').css('visibility','visible');
        },function(){
            $(this).find('.wenhao-alert').css('visibility','hidden');
        });

    });
    function formateyesterday(){
        var d = new Date();
        d.setTime(d.getTime()-24*60*60*1000);
        var curr_date = d.getDate();
        var curr_month = d.getMonth() + 1;
        var curr_year = d.getFullYear();
        String(curr_month).length < 2 ? (curr_month = "0" + curr_month): curr_month;
        String(curr_date).length < 2 ? (curr_date = "0" + curr_date): curr_date;
        var yyyyMMdd = curr_year + "" + curr_month +""+ curr_date;
        return yyyyMMdd;
    };

    function addPageUvCount(){
        var $actionday=formateyesterday();
        $.ajax({
            url:"../imstatics/getYesterdayUV?actionday="+$actionday+","+$actionday,
            type :"get",
            dataType : "JSON",
            data : {},
            success:function(data){
                $("span[name='indexPageUv']").html(data.indexPageUv);
                $("span[name='listPageUv']").html(data.listPageUv);
                $("span[name='detailPageUv']").html(data.detailPageUv);
                $("span[name='imCount']").html(data.imCount);
                $("span[name='sessionCount']").html(data.sessionCount);
                $("span[name='validSessionCount']").html(data.validSessionCount);
                $("span[name='invalidSessionCount']").html(data.invalidSessionCount);
            }
        })
    }

    function addTable1(){
        var $actionday=formateyesterday();
        $.ajax({
//            url:"/imstatics/citypercentageorder1?actionday=20181201,20181205",
//            url:"/imstatics/citypercentageorder1?actionday=20181201,20181205&city=北京,上海,广州,深圳,天津,武汉,成都,南京,青岛,杭州,重庆",
            url:"../imstatics/citypercentageorder1?actionday="+$actionday+","+$actionday+"&city=北京,上海,广州,深圳,天津,武汉,成都,南京,青岛,杭州,重庆",
            type :"get",
            dataType : "JSON",
            data : {},
            success: function(data){
                var taskHtml = '';
                for (i = 0; i < data.length; i++) {
                    taskHtml += '<tr >';
                    taskHtml += '<td >' + data[i].rank+'、'+data[i].name+'</td>';
                    taskHtml += '<td >' + data[i].percent+'%' + '</td>';
                    taskHtml += '</tr>';
                }
                $('#table1 tbody').html(taskHtml);

            }
        })
    }
    function addTable2(){
        var $actionday=formateyesterday();
        $.ajax({
//            url:"/imstatics/getpercentrankbybusiness2?actionday=20181201,20181205",
            url:"../imstatics/getpercentrankbybusiness2?actionday="+$actionday+","+$actionday,
            type :"get",
            dataType : "JSON",
            data : {},
            success: function(data){
                var taskHtml = '';
                for (i = 0; i < data.length; i++) {
                    taskHtml += '<tr >';
//                    taskHtml += '<td >' + data[i].rank+'、'+data[i].name+'('+data[i].percent+'%)' + '</td>';
                    taskHtml += '<td >' + data[i].rank+'、'+data[i].name.replace("挂牌","")+'</td>';
                    taskHtml += '<td >' + +data[i].percent+'%' + '</td>';
                    taskHtml += '</tr>';
                }
                $('#table2 tbody').html(taskHtml);

            }
        })
    }
    function addTable3(){
        var $actionday=formateyesterday();
        $.ajax({
            url:"../imstatics/getclickcountrankbybusiness3?actionday="+$actionday+"&platform=APP&business=新房挂牌&limit=10",
//            url:"/imstatics/getpercentrankbybusiness2?actionday="+$actionday+","+$actionday,
            type :"get",
            dataType : "JSON",
            data : {},
            success: function(data){
                var taskHtml = '';
                for (i = 0; i < data.length; i++) {
                    taskHtml += '<tr >';
//                    taskHtml += '<td >' + data[i].rank+'、'+data[i].name+'('+data[i].percent+'%)' + '</td>';
                    taskHtml += '<td >' + data[i].rank+'、'+data[i].pageName+'</td>';
                    taskHtml += '<td >' + data[i].name.replace("挂牌","") + '</td>';
                    taskHtml += '<td >' + data[i].chatuv + '</td>';
                    taskHtml += '</tr>';
                }
                $('#table3 tbody').html(taskHtml);

            }
        })
    }
    function addTable4(){
        var $actionday=formateyesterday();
        $.ajax({
//            url:"/imstatics/getAPPNewHouseUVList?actionday=20181201,20181201",
            url:"../imstatics/getAPPNewHouseUVList?actionday="+$actionday+","+$actionday,
//            url:"/imstatics/getpercentrankbybusiness2?actionday="+$actionday+","+$actionday,
            type :"get",
            dataType : "JSON",
            data : {},
            success: function(data){
                var taskHtml = '';
                for (i = 0; i < data.length; i++) {
                    taskHtml += '<tr >';
//                    taskHtml += '<td >' + data[i].rank+'、'+data[i].name+'('+data[i].percent+'%)' + '</td>';
                    taskHtml += '<td >' + (i+1)+'、'+data[i].projname+'</td>';
                    taskHtml += '<td >' + data[i].city + '</td>';
                    taskHtml += '<td >' + data[i].imchats + '</td>';
                    taskHtml += '</tr>';
                }
                $('#table4 tbody').html(taskHtml);

            }
        })
    }
    function tableClick() {
        $(".table td").click(function(){
            var sid = $(this).parent().find("td").eq(0).html();
            window.open("../xueyuan-more/"+sid);
        });
    };

</SCRIPT>


<!--<DIV class=header th:include="common2000::commontop" style="height: 60px">-->

</DIV>
<!-- 头部 E --><!-- 内容 [[ -->
<DIV class="container wrap" style="width: 100%">
    <!-- 侧边栏 [[ -->
    <!--<DIV th:include="common2000::commonNav(3,'im首页')" class=sidebar>-->

    </DIV><!-- 侧边栏 ]] --><!-- 主区域 [[ -->
    <!--<DIV id=art-content class=content style="width: 85%">&lt;!&ndash; 内容 [[ &ndash;&gt;-->
        <STYLE>.add SPAN {
            CURSOR: pointer;
            BORDER-TOP: #e7e7e7 1px solid;
            BORDER-RIGHT: #e7e7e7 1px solid;
            WIDTH: 12px;
            BORDER-BOTTOM: #e7e7e7 1px solid;
            PADDING-BOTTOM: 4px;
            TEXT-ALIGN: center;
            PADDING-TOP: 2px;
            BORDER-LEFT: #e7e7e7 1px solid;
            DISPLAY: inline-block;
            LINE-HEIGHT: 0.6;
            MARGIN-RIGHT: 5px;
            border-radius: 4px
        }

        .two TD:first-child {
            PADDING-LEFT: 37px
        }
        .wenhao{
            position: relative;
            float: left;
            margin: 7px 0 0 4px;
            padding-right: 10px;
            cursor: pointer;
        display: block;
        width: 15px;
        height: 15px;
        background: url(/img/sprite.png) -59px -1px;
        }
        .wenhao .wenhao-alert, .wenhao .wenhao-alert {
            position: absolute;
            z-index: 10;
            top: -14px;
            left: 30px;
            visibility: hidden;
            width: auto;
            height: 34px;
            min-width: 300px;
            padding: 8px 11px;
            color: #666;
            border: 1px solid #ddd;
            border-radius: 3px;
            background-color: #fff;
            background: url(/img/jiao1.png);
            font-size:12px;
            line-height: 16px;
        }

         .wenhao .wenhao-alert>i, .t .wenhao .wenhao-alert>i
        {
            position: absolute;
            top: 13px;
            left: -11px;
            width: 11px;
            height: 14px;

        }

        .c .wenhao {
            position: relative;
            top: 3px;
            display: inline-block;
            width: 15px;
            padding-right: 10px;
            cursor: pointer
        }

       .c .wenhao .wenhao-alert {
            font-size: 12px
        }
        </STYLE>

        <!--<DIV class=content-hd>-->
            <!--<H2 class=with-border>首页</H2>-->
        <!--</DIV>-->
        <!--<DIV class=content-bd>-->
           <!--<a href="im-list" target="view_window">im列表页</a>-->
           <!--<a href="im-uvcount-cs" target="view_window">分析图</a>-->
        <!--</DIV>-->
        <DIV class=content-bd>
            <div class="tit_con"><span style="font-size: 16px;line-height: 30px; float: left; margin-left: 8px;">昨日数据汇总</span><div class="wenhao">
                <i></i>
                <div class="wenhao-alert" style="visibility: hidden;"><i></i>昨日的APP 业务线按照设备号去重</div>
            </div></div>
            <div class="num_data clearfix">
                <ul>
                    <li><span class="icon_home" th:alt="昨日的访问APP首页的按照设备号去重的人数" name="indexPageUv">624,250</span></li>
                    <li >首页</li>
                </ul>
                <ul>
                    <li><span class="icon_list"  th:alt="昨日访问APP的所有列表页的按照设备号去重的人数" name="listPageUv">315,990</span></li>
                    <li>列表页</li>
                </ul>
                <ul>
                    <li><span class="icon_xq"  th:alt="昨日访问APP的所有详情页包括新房二手房租房家居案例家居产品的按照设备号去重的人数" name="detailPageUv">332,621</span></li>
                    <li>详情页</li>
                </ul>
                <ul>
                    <li><span class="icon_im"  th:alt="昨日访问APP的页面上所有的IM按钮人数" name="imCount">47,786</span></li>
                    <li>IM点击人数</li>
                </ul>
                <ul id="to-im-list">
                    <li><span class="icon_hh"  th:alt="昨日进入IM数据库的会话数按照发送者和接收者作为会话基本单位" name="sessionCount">122,321</span></li>
                    <li style="cursor:pointer">会话总数</li>
                </ul>
                <ul>
                    <li><span class="icon_fk"    th:title="昨日进入IM数据库的会话数B端业务有反馈的" name="validSessionCount">75,521</span></li>
                    <li>有反馈会话数</li>

                </ul>
                <ul class="bor_none">
                    <li><span class="icon_fkno"  th:alt="昨日进入IM数据库的会话数B端业务无反馈的" name="invalidSessionCount">46,800</span></li>
                    <li>无反馈会话数</li>

                </ul>
            </div>
            <div class="con">
                <div class="tit_con"><span style="font-size: 16px;line-height: 30px; float: left; margin-left: 8px;">回复率</span><div class="wenhao">
                    <i></i>
                    <div class="wenhao-alert" style="visibility: hidden;"><i></i>按照业务线计算回复率</div>
                </div></div>
                <div class="con_img clearfix">
                    <div class="con_img1">
                        <div class="img_box" id="newhouse_box" style="height: 278px;width: 400px">
                            <!--<img th:src="@{/im_index/images/img_con1_1.png}" alt=""/>-->
                            <!--<ul class="data_img">-->
                                <!--<li><span>11926</span></li>-->
                                <!--<li>总会话数</li>-->
                            <!--</ul>-->
                        </div>
                        <script>
                            function add_newhouse_box(){
                                var $actionday=formateyesterday();
                                var app = echarts.init(document.getElementById('newhouse_box'));

                                $.ajax({

                                    url:"../imstatics/getImStaticsPageuvChatByProducttype?actionday=20181201&producttype=新房挂牌",
//                                    url:"/imstatics/getImStaticsPageuvChatByProducttype?actionday="+$actionday+"&producttype=新房挂牌",
                                    type: "get",
                                    dataType: "JSON",
                                    data: {},
                                    success: function (data) {

                                        $("#newhouse_count").html("总会话数:"+data[0].uv);
                                        option = {
                                            tooltip : {
                                                trigger: 'item',
                                                formatter: "{a} <br/>{b} : {c} ({d}%)"
                                            },
                                            legend: {
                                                orient : 'vertical',
                                                x : 'left',
//                                                data:['有反馈会话数','无反馈会话数']
                                                data:[data[1].pagetype,data[2].pagetype]
                                            },
                                            toolbox: {
                                                show : true,
                                                feature : {
                                                    mark : {show: true},
                                                    dataView : {show: true, readOnly: false},
                                                    magicType : {
                                                        show: true,
                                                        type: ['pie', 'funnel'],
                                                        option: {
                                                            funnel: {
                                                                x: '25%',
                                                                width: '50%',
                                                                funnelAlign: 'center',
                                                                max: 1548
                                                            }
                                                        }
                                                    },
                                                    restore : {show: true},
                                                    saveAsImage : {show: true}
                                                }
                                            },
                                            calculable : true,
                                            series : [
                                                {
                                                    name:'新房',
                                                    type:'pie',
                                                    radius : ['50%', '70%'],
                                                    itemStyle : {
                                                        normal : {
                                                            label : {
                                                                show : false
                                                            },
                                                            labelLine : {
                                                                show : false
                                                            }
                                                        },
                                                        emphasis : {
                                                            label : {
                                                                show : true,
                                                                position : 'center',
                                                                textStyle : {
                                                                    fontSize : '10',
                                                                    fontWeight : 'bold'
                                                                }
                                                            }
                                                        }
                                                    },
                                                    data:[
                                                        {value:data[1].uv, name:data[1].pagetype},
                                                        {value:data[2].uv, name:data[2].pagetype}
//                                                        {value:335, name:'有反馈会话数'},
//                                                        {value:3100, name:'无反馈会话数'}
                                                    ]
                                                }
                                            ]
                                        };
                                        app.setOption(option);
                                    }
                                })

                            }
                        </script>
                        <p>新房</p>
                        <p id="newhouse_count"></p>
                    </div>
                    <div class="con_img1" >
                        <div class="img_box" id="esf_box" style="height: 278px;width: 400px">
                            <!--<img th:src="@{/im_index/images/img_con1_2.png}" alt=""/>-->
                            <!--<ul class="data_img">-->
                                <!--<li><span>110228</span></li>-->
                                <!--<li>总会话数</li>-->
                            <!--</ul>-->
                        </div>
                        <script>
                            function add_esf_box(){
                                var $actionday=formateyesterday();
                                var app = echarts.init(document.getElementById('esf_box'));

                                $.ajax({

                                    url:"../imstatics/getImStaticsPageuvChatByProducttype?actionday=20181201&producttype=二手房挂牌",
//                                    url:"/imstatics/getImStaticsPageuvChatByProducttype?actionday="+$actionday+"&producttype=二手房挂牌",
                                    type: "get",
                                    dataType: "JSON",
                                    data: {},
                                    success: function (data) {

                                        $("#esf_count").html("总会话数:"+data[0].uv);
                                        option = {
                                            tooltip : {
                                                trigger: 'item',
                                                formatter: "{a} <br/>{b} : {c} ({d}%)"
                                            },
                                            legend: {
                                                orient : 'vertical',
                                                x : 'left',
//                                                data:['有反馈会话数','无反馈会话数']
                                                data:[data[1].pagetype,data[2].pagetype]
                                            },
                                            toolbox: {
                                                show : true,
                                                feature : {
                                                    mark : {show: true},
                                                    dataView : {show: true, readOnly: false},
                                                    magicType : {
                                                        show: true,
                                                        type: ['pie', 'funnel'],
                                                        option: {
                                                            funnel: {
                                                                x: '25%',
                                                                width: '50%',
                                                                funnelAlign: 'center',
                                                                max: 1548
                                                            }
                                                        }
                                                    },
                                                    restore : {show: true},
                                                    saveAsImage : {show: true}
                                                }
                                            },
                                            calculable : true,
                                            series : [
                                                {
                                                    name:'二手房',
                                                    type:'pie',
                                                    radius : ['50%', '70%'],
                                                    itemStyle : {
                                                        normal : {
                                                            label : {
                                                                show : false
                                                            },
                                                            labelLine : {
                                                                show : false
                                                            }
                                                        },
                                                        emphasis : {
                                                            label : {
                                                                show : true,
                                                                position : 'center',
                                                                textStyle : {
                                                                    fontSize : '10',
                                                                    fontWeight : 'bold'
                                                                }
                                                            }
                                                        }
                                                    },
                                                    data:[
                                                        {value:data[1].uv, name:data[1].pagetype},
                                                        {value:data[2].uv, name:data[2].pagetype}
//                                                        {value:335, name:'有反馈会话数'},
//                                                        {value:3100, name:'无反馈会话数'}
                                                    ]
                                                }
                                            ]
                                        };
                                        app.setOption(option);
                                    }
                                })

                            }
                        </script>
                        <p>二手房</p>
                        <p id="esf_count"></p>
                    </div>
                    <div class="con_img1">
                        <div class="img_box" id="jj_box" style="height: 278px;width: 400px">
                            <!--<img th:src="@{/im_index/images/img_con1_3.png}" alt=""/>-->
                            <!--<ul class="data_img">-->
                                <!--<li><span>167</span></li>-->
                                <!--<li>总会话数</li>-->
                            <!--</ul>-->
                        </div>
                        <script>
                            function add_jj_box(){
                                var $actionday=formateyesterday();
                                var app = echarts.init(document.getElementById('jj_box'));

                                $.ajax({

                                    url:"../imstatics/getImStaticsPageuvChatByProducttype?actionday=20181201&producttype=家居挂牌",
//                                    url:"/imstatics/getImStaticsPageuvChatByProducttype?actionday="+$actionday+"&producttype=家居挂牌",
                                    type: "get",
                                    dataType: "JSON",
                                    data: {},
                                    success: function (data) {

                                        $("#jj_count").html("总会话数:"+data[0].uv);
                                        option = {
                                            tooltip : {
                                                trigger: 'item',
                                                formatter: "{a} <br/>{b} : {c} ({d}%)"
                                            },
                                            legend: {
                                                orient : 'vertical',
                                                x : 'left',
//                                                data:['有反馈会话数','无反馈会话数']
                                                data:[data[1].pagetype,data[2].pagetype]
                                            },
                                            toolbox: {
                                                show : true,
                                                feature : {
                                                    mark : {show: true},
                                                    dataView : {show: true, readOnly: false},
                                                    magicType : {
                                                        show: true,
                                                        type: ['pie', 'funnel'],
                                                        option: {
                                                            funnel: {
                                                                x: '25%',
                                                                width: '50%',
                                                                funnelAlign: 'center',
                                                                max: 1548
                                                            }
                                                        }
                                                    },
                                                    restore : {show: true},
                                                    saveAsImage : {show: true}
                                                }
                                            },
                                            calculable : true,
                                            series : [
                                                {
                                                    name:'家居',
                                                    type:'pie',
                                                    radius : ['50%', '70%'],
                                                    itemStyle : {
                                                        normal : {
                                                            label : {
                                                                show : false
                                                            },
                                                            labelLine : {
                                                                show : false
                                                            }
                                                        },
                                                        emphasis : {
                                                            label : {
                                                                show : true,
                                                                position : 'center',
                                                                textStyle : {
                                                                    fontSize : '10',
                                                                    fontWeight : 'bold'
                                                                }
                                                            }
                                                        }
                                                    },
                                                    data:[
                                                        {value:data[1].uv, name:data[1].pagetype},
                                                        {value:data[2].uv, name:data[2].pagetype}
//                                                        {value:335, name:'有反馈会话数'},
//                                                        {value:3100, name:'无反馈会话数'}
                                                    ]
                                                }
                                            ]
                                        };
                                        app.setOption(option);
                                    }
                                })

                            }
                        </script>
                        <p>家居</p>
                        <p id="jj_count"></p>
                    </div>
                    <div class="clear"></div>
                    <!--<div class="note_com">-->
                        <!--<div class="clearfix">-->
                            <!--<p class="icon_blue"><i></i>无反馈会话数</p>-->
                            <!--<p class="icon_red"><i></i>有反馈会话数</p>-->
                        <!--</div>-->
                    <!--</div>-->
                </div>
            </div>
            <div class="data-bd" style="margin-left: 56px;">
                <div class="tit_con">全国一线城市的用户从详情页到点击房聊按钮的转换率<a href="../dataItem/im-uvcount-citys1" target="view_window">查看具体城市</a></div>

                <div name="table" style="height:400px;width: 20%;float: left">
                    <TABLE class="table table-hover" id="table1">
                        <THEAD>
                        <TR>
                            <TH class=var>全国城市排行</TH>
                            <TH class=var>转化率</TH>
                        </TR>
                        </THEAD>
                        <tbody>
                        <!--<tr><td>上海</td></tr>-->
                        <!--<tr><td>北京</td></tr>-->
                        <!--<tr><td>深圳</td></tr>-->
                        <!--<tr><td>广州</td></tr>-->
                        <!--<tr><td>武汉</td></tr>-->
                        </tbody>
                    </TABLE>
                </div>
                <div id="main1" style="height:400px;width: 80%;float: right"></div>
                    <script>
                        function showCharts1(){
                            var $actionday=formateyesterday();
                            /*<![CDATA[*/
                            // 基于准备好的dom，初始化echarts图表
                            var app = echarts.init(document.getElementById('main1'));
//                            var $starttime =$("#starttime").val().replace("-","").replace("-","");
//                            var $endtime =$("#endtime").val().replace("-","").replace("-","");
                            var $city = $("#city").val() == null ? "上海,北京,广州,深圳" : $("#city").val()

                            $.ajax({
//                                url:"/imstatics/getcitycount1?actionday="+$starttime+","+$endtime+"&city="+$city,
//                                url:"/imstatics/getcitycount1?actionday=20181201,20181212&city=上海,北京,广州,深圳",
                                url:"../imstatics/getcitycount1?actionday="+$actionday+","+$actionday+"&city=北京,上海,广州,深圳,天津,武汉,成都,南京,青岛,杭州,重庆",
                                type :"get",
                                dataType : "JSON",
                                data : {},
                                success: function(data){

                                    option = {
                                        tooltip: {
                                            trigger: 'axis'
                                        },
                                        toolbox: {
                                            show: true,
                                            feature: {
                                                mark: {show: true},
                                                dataView: {show: true, readOnly: false},
                                                magicType: {show: true, type: ['line', 'bar']},
                                                restore: {show: true},
                                                saveAsImage: {show: true}
                                            }
                                        },
                                        calculable: true,
                                        legend: {
                                            data: data.line
                                        },
                                        xAxis: [
                                            {
                                                type: 'category',
                                                data: data.x
                                            }
                                        ],
                                        yAxis: [
                                            {
                                                type: 'value',
                                                name: '人数',
                                                axisLabel: {
                                                    formatter: '{value}'
                                                }
                                            },
                                            {
                                                type: 'value',
                                                name: '转化率',
                                                axisLabel: {
                                                    formatter: '{value} %'
                                                }
                                            }
                                        ],
                                        series: data.series
                                    }
                                    // 为echarts对象加载数据
                                    app.setOption(option);
                                    /*]]>*/
                                }

                            })
                        }

                    </script>

            </div>
            <div class="data-bd" style="margin-top: 450px;margin-left: 56px;">
                <div class="tit_con">全国各个业务线的用户从详情页到点击房聊按钮的转换率<a href="../dataItem/im-uvcount-services1" target="view_window">查看具体城市</a></div>
                <div name="table" style="height:400px;width: 20%;float: left">
                    <TABLE class="table table-hover" id="table2">
                        <THEAD>
                        <TR>
                            <TH class=var>全国城市排行</TH>
                            <TH class=var>转化率</TH>
                        </TR>
                        </THEAD>
                        <tbody>
                        <!--<tr><td>上海</td></tr>-->
                        <!--<tr><td>北京</td></tr>-->
                        <!--<tr><td>深圳</td></tr>-->
                        <!--<tr><td>广州</td></tr>-->
                        <!--<tr><td>武汉</td></tr>-->
                        </tbody>
                    </TABLE>
                </div>
                <div  id="main2" style="height:400px;width: 80%;float: right"></div>
                    <script>
                        function showCharts2(){
                            var $actionday=formateyesterday();
                            /*<![CDATA[*/
                            // 基于准备好的dom，初始化echarts图表
                            var app = echarts.init(document.getElementById('main2'));
//                            var $starttime =$("#starttime").val().replace("-","").replace("-","");
//                            var $endtime =$("#endtime").val().replace("-","").replace("-","");

                            $.ajax({
                                url:"../imstatics/getonecitycount2?actionday="+$actionday+","+$actionday+"&city=",
                                type :"get",
                                dataType : "JSON",
                                data : {},
                                success: function(data){
//                                    alert(data.x)
//                                    var reg = new RegExp("挂牌","g")
//                                    var reg2 = new RegExp("\"","g")
//                                    var reg3 = new RegExp("[","g")
//                                    var reg4 = new RegExp("]","g")
//alert(JSON.stringify(data.x).replace(reg,""));
//                                    data.x=JSON.stringify(data.x).replace(reg,"").replace(reg2,"").replace(reg3,"").replace(reg4,"");
//                                    alert(data.x)
                                    var reg = new RegExp("挂牌","g")
                                    data.x=JSON.parse(JSON.stringify(data.x).replace(reg,""))
//
                                    option = {
                                        tooltip: {
                                            trigger: 'axis'
                                        },
                                        toolbox: {
                                            show: true,
                                            feature: {
                                                mark: {show: true},
                                                dataView: {show: true, readOnly: false},
                                                magicType: {show: true, type: ['line', 'bar']},
                                                restore: {show: true},
                                                saveAsImage: {show: true}
                                            }
                                        },
                                        calculable: true,
                                        legend: {
                                            data: data.line
                                        },
                                        xAxis: [
                                            {
                                                type: 'category',
                                               data: data.x
                                                //data: ["新房","二手房","租房","家居"]
                                            }
                                        ],
                                        yAxis: [
                                            {
                                                type: 'value',
                                                name: '人数',
                                                axisLabel: {
                                                    formatter: '{value}'
                                                }
                                            },
                                            {
                                                type: 'value',
                                                name: '转化率',
                                                axisLabel: {
                                                    formatter: '{value} %'
                                                }
                                            }
                                        ],
                                        series: data.series
                                    }
                                    // 为echarts对象加载数据
                                    app.setOption(option);
                                    /*]]>*/
                                }

                            })
                        }

                    </script>
            </div>

            <div class="data-bd" style="margin-top: 400px;margin-left: 56px;">
                <div class="tit_con">APP新房个各页面房聊按钮点击人数排行</div>
                <div name="table" style="height:400px;width: 34%;float: left">
                    <TABLE class="table table-hover" id="table3">
                        <THEAD>
                        <TR>
                            <TH class=var>页面名称</TH>
                            <TH class=var>业务线</TH>
                            <TH class=var>im点击量</TH>
                        </TR>
                        </THEAD>
                        <tbody>
                        <!--<tr>-->
                            <!--<td>上海</td>-->
                            <!--<td>2%</td>-->
                            <!--<td>2%</td>-->
                        <!--</tr>-->
                        <!--<tr><td>北京</td><td>2%</td><td>2%</td></tr>-->
                        <!--<tr><td>深圳</td><td>2%</td><td>2%</td></tr>-->
                        <!--<tr><td>广州</td><td>2%</td><td>2%</td></tr>-->
                        <!--<tr><td>武汉</td><td>2%</td><td>2%</td></tr>-->
                        </tbody>
                    </TABLE>
                </div>
                <div  id="main3" style="height:400px;width: 66%;float: right"></div>
                    <script>
                        function showCharts3(){
                            var $actionday=formateyesterday();
                            /*<![CDATA[*/
                            // 基于准备好的dom，初始化echarts图表
                            var app = echarts.init(document.getElementById('main3'));
//                            var $starttime =$("#starttime").val().replace("-","").replace("-","");
//                            var $endtime =$("#endtime").val().replace("-","").replace("-","");

                            $.ajax({
//                                url:"/imstatics/getonecitycount2?actionday=20181201,20181212&city=",
                                url:"../imstatics/getclickpercentrankbybusiness4?actionday="+$actionday+"&platform=APP&business=新房挂牌&limit=10",
                                type :"get",
                                dataType : "JSON",
                                data : {},
                                success: function(data){

                                    option = {
                                        tooltip: {
                                            trigger: 'axis'
                                        },
                                        toolbox: {
                                            show: true,
                                            feature: {
                                                mark: {show: true},
                                                dataView: {show: true, readOnly: false},
                                                magicType: {show: true, type: ['line', 'bar']},
                                                restore: {show: true},
                                                saveAsImage: {show: true}
                                            }
                                        },
                                        calculable: true,
                                        legend: {
                                            data: data.line
                                        },
                                        xAxis: [
                                            {
                                                type: 'category',
                                                data: data.x
                                            }
                                        ],
                                        yAxis: [
                                            {
                                                type: 'value',
                                                name: '人数',
                                                axisLabel: {
                                                    formatter: '{value}'
                                                }
                                            },
                                            {
                                                type: 'value',
                                                name: '转化率',
                                                axisLabel: {
                                                    formatter: '{value} %'
                                                }
                                            }
                                        ],
                                        series: data.series
                                    }
                                    // 为echarts对象加载数据
                                    app.setOption(option);
                                    /*]]>*/
                                }
                            })
                        }

                    </script>
            </div>



            <div class="data-bd" style="margin-top: 450px;margin-left: 56px;">
                <div class="tit_con">APP新房楼盘聊天数排行</div>
                <div name="table" style="height:400px;width: 34%;float: left">
                    <TABLE class="table table-hover" id="table5">
                        <THEAD>
                        <TR>
                            <TH class=var>楼盘名</TH>
                            <TH class=var>城市</TH>
                            <TH class=var>im聊天数</TH>
                        </TR>
                        </THEAD>
                        <tbody>

                        </tbody>
                    </TABLE>
                </div>
                <div  id="main4" style="height:400px;width: 66%;float: right"></div>
                <script>
                    function showCharts4(){
                        var $actionday=formateyesterday();
                        /*<![CDATA[*/
                        // 基于准备好的dom，初始化echarts图表
                        var app = echarts.init(document.getElementById('main4'));
//                            var $starttime =$("#starttime").val().replace("-","").replace("-","");
//                            var $endtime =$("#endtime").val().replace("-","").replace("-","");
                        $.ajax({
//                                url:"/imstatics/getonecitycount2?actionday=20181201,20181212&city=",
                            url:"../imstatics/getAPPNewHouseUV?actionday="+$actionday+","+$actionday,
//                            url:"/imstatics/getAPPNewHouseUV?actionday=20181201,20181201",
                            type :"get",
                            dataType : "JSON",
                            data : {},
                            success: function(data){
                                option = {
                                    tooltip: {
                                        trigger: 'axis'
                                    },
                                    toolbox: {
                                        show: true,
                                        feature: {
                                            mark: {show: true},
                                            dataView: {show: true, readOnly: false},
                                            magicType: {show: true, type: ['line', 'bar']},
                                            restore: {show: true},
                                            saveAsImage: {show: true}
                                        }
                                    },
                                    calculable: true,

                                    xAxis: [
                                        {
                                            type: 'category',
//                                            data : ['新湖·庐山国际','富力和园','苏虎街商品楼','保利香槟国际','保利新武昌','盛秦西苑','荣盛·汤泉首岭','康诗丹郡','龙光城','北戴河孔雀城']
                                           data : data.x

                                        }
                                    ],
                                    yAxis: [
                                        {
                                            type: 'value',
                                            name: '聊天数',
                                            axisLabel: {
                                                formatter: '{value}'
                                            }
                                        }
                                    ],
                                    series : data.series
//                                    series : [
//                                        {
//                                            name:'聊天数',
//                                            type:'bar',
//                                            data:[224,158,156,153,128,126,124,103,101,100]
//                                        }
//                                    ]
                                }
                                // 为echarts对象加载数据
                                app.setOption(option);
                                /*]]>*/
                            }
                        })

                    }

                </script>
            </div>

        </DIV>



<!--<DIV class=page-right>-->
    <!--<DIV class=Catalog-box>-->
        <!--<DIV id=Catalog-box></DIV>-->
        <!--<DIV class=complaints>-->
            <!--<UL>-->
                <!--<LI><A href="#">返回顶部</A></LI>-->
            <!--</UL>-->
        <!--</DIV>-->
    <!--</DIV>-->
<!--</DIV>-->
<DIV th:include="common2000::footer" class=footer>
</DIV>
</div>
    <!--</DIV>-->
</BODY>
</HTML>
